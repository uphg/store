<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React Hooks 入门教程 | Store Note</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600|Open+Sans:400,600;display=swap" rel="stylesheet">
    <script src="/store/icon/svg.js"></script>
    <meta name="description" content="分享/转载，我收集的一些前端的博客、教程等（内容大部分为转载）。">
    
    <link rel="preload" href="/store/assets/css/0.styles.63d1068c.css" as="style"><link rel="preload" href="/store/assets/js/app.394edd4d.js" as="script"><link rel="preload" href="/store/assets/js/2.47c138cf.js" as="script"><link rel="preload" href="/store/assets/js/10.5991f066.js" as="script"><link rel="prefetch" href="/store/assets/js/11.b720c46d.js"><link rel="prefetch" href="/store/assets/js/12.732d7e14.js"><link rel="prefetch" href="/store/assets/js/13.36b70fac.js"><link rel="prefetch" href="/store/assets/js/14.05183c62.js"><link rel="prefetch" href="/store/assets/js/15.7c5b5bdc.js"><link rel="prefetch" href="/store/assets/js/16.209846e1.js"><link rel="prefetch" href="/store/assets/js/17.a5ebad70.js"><link rel="prefetch" href="/store/assets/js/18.1be799ce.js"><link rel="prefetch" href="/store/assets/js/19.b34fb98d.js"><link rel="prefetch" href="/store/assets/js/20.09a1eaf3.js"><link rel="prefetch" href="/store/assets/js/21.b3963c90.js"><link rel="prefetch" href="/store/assets/js/22.ec97312d.js"><link rel="prefetch" href="/store/assets/js/23.a163377b.js"><link rel="prefetch" href="/store/assets/js/24.6275c188.js"><link rel="prefetch" href="/store/assets/js/25.cbc926dd.js"><link rel="prefetch" href="/store/assets/js/26.86c46bec.js"><link rel="prefetch" href="/store/assets/js/27.3d81ab36.js"><link rel="prefetch" href="/store/assets/js/28.8fb3867a.js"><link rel="prefetch" href="/store/assets/js/29.a066a763.js"><link rel="prefetch" href="/store/assets/js/3.66aba1d2.js"><link rel="prefetch" href="/store/assets/js/30.c50eb8b0.js"><link rel="prefetch" href="/store/assets/js/4.68e87ae4.js"><link rel="prefetch" href="/store/assets/js/5.a95fabbf.js"><link rel="prefetch" href="/store/assets/js/6.1bf59d34.js"><link rel="prefetch" href="/store/assets/js/7.bc383402.js"><link rel="prefetch" href="/store/assets/js/8.74ff4d35.js"><link rel="prefetch" href="/store/assets/js/9.2072f0c5.js">
    <link rel="stylesheet" href="/store/assets/css/0.styles.63d1068c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/store/" class="home-link router-link-active"><!----> <span class="site-name">Store Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----> <svg aria-hidden="true" class="icon search-icon"><use xlink:href="#icon-search"></use></svg></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/store/bookmarks/" class="nav-link">
  收藏夹
</a></div><div class="nav-item"><a href="/store/js/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/store/devbook/" class="nav-link">
  开发者手册
</a></div><div class="nav-item"><a href="/store/react/" class="nav-link router-link-active">
  React 教程
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div class="el-scrollbar"><div class="scrollbar-wrapper el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><div class="el-scrollbar__view"><nav class="nav-links"><div class="nav-item"><a href="/store/bookmarks/" class="nav-link">
  收藏夹
</a></div><div class="nav-item"><a href="/store/js/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/store/devbook/" class="nav-link">
  开发者手册
</a></div><div class="nav-item"><a href="/store/react/" class="nav-link router-link-active">
  React 教程
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/store/react/" aria-current="page" class="sidebar-link">介绍</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>React 入门教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/store/react/react-technology-stack.html" class="sidebar-link">React 技术栈系列教程</a></li><li><a href="/store/react/react-started.html" class="sidebar-link">React 入门实例教程（旧）</a></li><li><a href="/store/react/react-hooks.html" aria-current="page" class="active sidebar-link">React Hooks 入门教程</a></li><li><a href="/store/react/react-hooks-useeffect.html" class="sidebar-link">轻松学会 React 钩子：以 useEffect() 为例</a></li><li><a href="/store/react/react-router.html" class="sidebar-link">React Router 使用教程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redux 入门教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/store/react/redux/redux-part-basic.html" class="sidebar-link">一、基本用法</a></li><li><a href="/store/react/redux/redux-part-async-operations.html" class="sidebar-link">二、中间件与异步操作</a></li><li><a href="/store/react/redux/redux-part-react.html" class="sidebar-link">三、React-Redux 的用法</a></li></ul></section></li></ul> </div></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></aside> <main class="page"> <div class="re-page-top"><h1 class="title"><span>React Hooks 入门教程</span></h1> <div class="re-page-index"><div class="page-index-title"><span class="open-catalog"><svg aria-hidden="true" class="icon arrow-right"><use xlink:href="#icon-bold-right"></use></svg> <span class="text">目录</span></span></div> <div class="page-index-content"><div class="page-catalog" style="display:none;"><div><ul><li><a href="/store/react/react-hooks.html#一、组件类的缺点">一、组件类的缺点</a></li><li><a href="/store/react/react-hooks.html#二、函数组件">二、函数组件</a></li><li><a href="/store/react/react-hooks.html#三、hook-的含义">三、Hook 的含义</a></li><li><a href="/store/react/react-hooks.html#四、usestate-状态钩子">四、useState()：状态钩子</a></li><li><a href="/store/react/react-hooks.html#五、usecontext-共享状态钩子">五、useContext()：共享状态钩子</a></li><li><a href="/store/react/react-hooks.html#六、usereducer-action-钩子">六、useReducer()：action 钩子</a></li><li><a href="/store/react/react-hooks.html#七、useeffect-副作用钩子">七、useEffect()：副作用钩子</a></li><li><a href="/store/react/react-hooks.html#八、创建自己的-hooks">八、创建自己的 Hooks</a></li><li><a href="/store/react/react-hooks.html#九、参考链接">九、参考链接</a></li></ul></div></div></div></div></div> <div class="theme-default-content content__default" data-v-68cf6ec2 data-v-68cf6ec2><hr data-v-68cf6ec2> <p data-v-68cf6ec2>作者： <a href="http://www.ruanyifeng.com/" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>阮一峰<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p data-v-68cf6ec2>日期： <a href="http://www.ruanyifeng.com/blog/2019/09/" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>2019年9月 1日<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <hr data-v-68cf6ec2> <p data-v-68cf6ec2>React 是主流的前端框架，v16.8 版本引入了全新的 API，叫做 <a href="https://reactjs.org/docs/hooks-reference.html" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>React Hooks<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，颠覆了以前的用法。</p> <p data-v-68cf6ec2><img src="https://www.wangbase.com/blogimg/asset/201908/bg2019083104.jpg" alt="img" data-v-68cf6ec2></p> <p data-v-68cf6ec2>这个 API 是 React 的未来，有必要深入理解。本文谈谈我的理解，简单介绍它的用法，帮助大家快速上手。</p> <p data-v-68cf6ec2>阅读本文需要有 React 基础。如果你还没学会 React，可以先看一下<a href="https://github.com/ruanyf/react-demos" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>它的教程<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p data-v-68cf6ec2>[更新] 我后来又写了一篇<a href="http://www.ruanyifeng.com/blog/2020/09/react-hooks-useeffect-tutorial.html" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>《轻松学会 React 钩子：以 useEffect() 为例》<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，补充了对 Hooks 设计思想的解释，建议大家可以先阅读那篇文章。</p> <h2 id="一、组件类的缺点" data-v-68cf6ec2><a href="#一、组件类的缺点" class="header-anchor" data-v-68cf6ec2>#</a> 一、组件类的缺点</h2> <p data-v-68cf6ec2>React 的核心是组件。v16.8 版本之前，组件的标准写法是类（class）。下面是一个简单的组件类。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>import</span> React<span class="token punctuation" data-v-68cf6ec2>,</span> <span class="token punctuation" data-v-68cf6ec2>{</span> Component <span class="token punctuation" data-v-68cf6ec2>}</span> <span class="token keyword" data-v-68cf6ec2>from</span> <span class="token string" data-v-68cf6ec2>&quot;react&quot;</span><span class="token punctuation" data-v-68cf6ec2>;</span>

<span class="token keyword" data-v-68cf6ec2>export</span> <span class="token keyword" data-v-68cf6ec2>default</span> <span class="token keyword" data-v-68cf6ec2>class</span> <span class="token class-name" data-v-68cf6ec2>Button</span> <span class="token keyword" data-v-68cf6ec2>extends</span> <span class="token class-name" data-v-68cf6ec2>Component</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token function" data-v-68cf6ec2>constructor</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>super</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
    <span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>.</span>state <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>{</span> buttonText<span class="token operator" data-v-68cf6ec2>:</span> <span class="token string" data-v-68cf6ec2>&quot;Click me, please&quot;</span> <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>;</span>
    <span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>.</span>handleClick <span class="token operator" data-v-68cf6ec2>=</span> <span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>handleClick</span><span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>bind</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>
  <span class="token function" data-v-68cf6ec2>handleClick</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>setState</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
      <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token punctuation" data-v-68cf6ec2>{</span> buttonText<span class="token operator" data-v-68cf6ec2>:</span> <span class="token string" data-v-68cf6ec2>&quot;Thanks, been clicked!&quot;</span> <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>;</span>
    <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>
  <span class="token function" data-v-68cf6ec2>render</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>{</span> buttonText <span class="token punctuation" data-v-68cf6ec2>}</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>.</span>state<span class="token punctuation" data-v-68cf6ec2>;</span>
    <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>button</span> <span class="token attr-name" data-v-68cf6ec2>onClick</span><span class="token script language-javascript" data-v-68cf6ec2><span class="token script-punctuation punctuation" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>{</span><span class="token keyword" data-v-68cf6ec2>this</span><span class="token punctuation" data-v-68cf6ec2>.</span>handleClick<span class="token punctuation" data-v-68cf6ec2>}</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>{</span>buttonText<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>button</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><section class="re-part" data-v-68cf6ec2><button data-v-68cf6ec2>Click me, please</button></section> <blockquote data-v-68cf6ec2><p data-v-68cf6ec2>点击查看<a href="https://codesandbox.io/s/funny-forest-ncv8b" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>运行结果<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p data-v-68cf6ec2>这个组件类仅仅是一个按钮，但可以看到，它的代码已经很&quot;重&quot;了。真实的 React App 由多个类按照层级，一层层构成，复杂度成倍增长。再加入 Redux，就变得更复杂。</p> <p data-v-68cf6ec2>Redux 的作者 Dan Abramov <a href="https://medium.com/@dan_abramov/making-sense-of-react-hooks-fdbde8803889" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>总结<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>了组件类的几个缺点。</p> <blockquote data-v-68cf6ec2><ul data-v-68cf6ec2><li data-v-68cf6ec2>大型组件很难拆分和重构，也很难测试。</li> <li data-v-68cf6ec2>业务逻辑分散在组件的各个方法之中，导致重复逻辑或关联逻辑。</li> <li data-v-68cf6ec2>组件类引入了复杂的编程模式，比如 render props 和高阶组件。</li></ul></blockquote> <h2 id="二、函数组件" data-v-68cf6ec2><a href="#二、函数组件" class="header-anchor" data-v-68cf6ec2>#</a> 二、函数组件</h2> <p data-v-68cf6ec2>React 团队希望，组件不要变成复杂的容器，最好只是数据流的管道。开发者根据需要，组合管道即可。 <strong data-v-68cf6ec2>组件的最佳写法应该是函数，而不是类。</strong></p> <p data-v-68cf6ec2>React 早就支持<a href="https://reactjs.org/docs/components-and-props.html" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>函数组件<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下面就是一个例子。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>function</span> <span class="token function" data-v-68cf6ec2>Welcome</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>props</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>h1</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Hello, </span><span class="token punctuation" data-v-68cf6ec2>{</span>props<span class="token punctuation" data-v-68cf6ec2>.</span>name<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>h1</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>;</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><p data-v-68cf6ec2>但是，这种写法有重大限制，必须是纯函数，不能包含状态，也不支持生命周期方法，因此无法取代类。</p> <p data-v-68cf6ec2><strong data-v-68cf6ec2>React Hooks 的设计目的，就是加强版函数组件，完全不使用&quot;类&quot;，就能写出一个全功能的组件。</strong></p> <h2 id="三、hook-的含义" data-v-68cf6ec2><a href="#三、hook-的含义" class="header-anchor" data-v-68cf6ec2>#</a> 三、Hook 的含义</h2> <p data-v-68cf6ec2>Hook 这个单词的意思是&quot;钩子&quot;。</p> <p data-v-68cf6ec2><strong data-v-68cf6ec2>React Hooks 的意思是，组件尽量写成纯函数，如果需要外部功能和副作用，就用钩子把外部代码&quot;钩&quot;进来。</strong> React Hooks 就是那些钩子。</p> <p data-v-68cf6ec2>你需要什么功能，就使用什么钩子。React 默认提供了一些常用钩子，你也可以封装自己的钩子。</p> <p data-v-68cf6ec2>所有的钩子都是为函数引入外部功能，所以 React 约定，钩子一律使用<code data-v-68cf6ec2>use</code>前缀命名，便于识别。你要使用 xxx 功能，钩子就命名为 usexxx。</p> <p data-v-68cf6ec2>下面介绍 React 默认提供的四个最常用的钩子。</p> <blockquote data-v-68cf6ec2><ul data-v-68cf6ec2><li data-v-68cf6ec2>useState()</li> <li data-v-68cf6ec2>useContext()</li> <li data-v-68cf6ec2>useReducer()</li> <li data-v-68cf6ec2>useEffect()</li></ul></blockquote> <h2 id="四、usestate-状态钩子" data-v-68cf6ec2><a href="#四、usestate-状态钩子" class="header-anchor" data-v-68cf6ec2>#</a> 四、useState()：状态钩子</h2> <p data-v-68cf6ec2><code data-v-68cf6ec2>useState()</code>用于为函数组件引入状态（state）。纯函数不能有状态，所以把状态放在钩子里面。</p> <p data-v-68cf6ec2>本文前面那个组件类，用户点击按钮，会导致按钮的文字改变，文字取决于用户是否点击，这就是状态。使用<code data-v-68cf6ec2>useState()</code>重写如下。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>import</span> React<span class="token punctuation" data-v-68cf6ec2>,</span> <span class="token punctuation" data-v-68cf6ec2>{</span> useState <span class="token punctuation" data-v-68cf6ec2>}</span> <span class="token keyword" data-v-68cf6ec2>from</span> <span class="token string" data-v-68cf6ec2>&quot;react&quot;</span><span class="token punctuation" data-v-68cf6ec2>;</span>

<span class="token keyword" data-v-68cf6ec2>export</span> <span class="token keyword" data-v-68cf6ec2>default</span> <span class="token keyword" data-v-68cf6ec2>function</span>  <span class="token function" data-v-68cf6ec2>Button</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span>  <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span>  <span class="token punctuation" data-v-68cf6ec2>[</span>buttonText<span class="token punctuation" data-v-68cf6ec2>,</span> setButtonText<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span>  <span class="token function" data-v-68cf6ec2>useState</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token string" data-v-68cf6ec2>&quot;Click me, please&quot;</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>

  <span class="token keyword" data-v-68cf6ec2>function</span> <span class="token function" data-v-68cf6ec2>handleClick</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span>  <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token function" data-v-68cf6ec2>setButtonText</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token string" data-v-68cf6ec2>&quot;Thanks, been clicked!&quot;</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>

  <span class="token keyword" data-v-68cf6ec2>return</span>  <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>button</span>  <span class="token attr-name" data-v-68cf6ec2>onClick</span><span class="token script language-javascript" data-v-68cf6ec2><span class="token script-punctuation punctuation" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>{</span>handleClick<span class="token punctuation" data-v-68cf6ec2>}</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>{</span>buttonText<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>button</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>;</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><section class="re-part" data-v-68cf6ec2><button data-v-68cf6ec2>Click me, please</button></section> <blockquote data-v-68cf6ec2><p data-v-68cf6ec2>点击查看<a href="https://codesandbox.io/s/nifty-waterfall-4i2dq" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>运行结果<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p data-v-68cf6ec2>上面代码中，Button 组件是一个函数，内部使用<code data-v-68cf6ec2>useState()</code>钩子引入状态。</p> <p data-v-68cf6ec2><code data-v-68cf6ec2>useState()</code>这个函数接受状态的初始值，作为参数，上例的初始值为按钮的文字。该函数返回一个数组，数组的第一个成员是一个变量（上例是<code data-v-68cf6ec2>buttonText</code>），指向状态的当前值。第二个成员是一个函数，用来更新状态，约定是<code data-v-68cf6ec2>set</code>前缀加上状态的变量名（上例是<code data-v-68cf6ec2>setButtonText</code>）。</p> <h2 id="五、usecontext-共享状态钩子" data-v-68cf6ec2><a href="#五、usecontext-共享状态钩子" class="header-anchor" data-v-68cf6ec2>#</a> 五、useContext()：共享状态钩子</h2> <p data-v-68cf6ec2>如果需要在组件之间共享状态，可以使用<code data-v-68cf6ec2>useContext()</code>。</p> <p data-v-68cf6ec2>现在有两个组件 Navbar 和 Messages，我们希望它们之间共享状态。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span> <span class="token attr-name" data-v-68cf6ec2>className</span><span class="token attr-value" data-v-68cf6ec2><span class="token punctuation attr-equals" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>&quot;</span>App<span class="token punctuation" data-v-68cf6ec2>&quot;</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
  </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span><span class="token class-name" data-v-68cf6ec2>Navbar</span></span><span class="token punctuation" data-v-68cf6ec2>/&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
  </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span><span class="token class-name" data-v-68cf6ec2>Messages</span></span><span class="token punctuation" data-v-68cf6ec2>/&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
</code></pre></div><p data-v-68cf6ec2>第一步就是使用 React Context API，在组件外部建立一个 Context。</p> <div class="language-javascript extra-class" data-v-68cf6ec2><pre class="language-javascript" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> AppContext <span class="token operator" data-v-68cf6ec2>=</span> React<span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>createContext</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>{</span><span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
</code></pre></div><p data-v-68cf6ec2>组件封装代码如下。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span><span class="token class-name" data-v-68cf6ec2>AppContext.Provider</span></span> <span class="token attr-name" data-v-68cf6ec2>value</span><span class="token script language-javascript" data-v-68cf6ec2><span class="token script-punctuation punctuation" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>{</span><span class="token punctuation" data-v-68cf6ec2>{</span>
  username<span class="token operator" data-v-68cf6ec2>:</span> <span class="token string" data-v-68cf6ec2>'superawesome'</span>
<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>}</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
  </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span> <span class="token attr-name" data-v-68cf6ec2>className</span><span class="token attr-value" data-v-68cf6ec2><span class="token punctuation attr-equals" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>&quot;</span>App<span class="token punctuation" data-v-68cf6ec2>&quot;</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span><span class="token class-name" data-v-68cf6ec2>Navbar</span></span><span class="token punctuation" data-v-68cf6ec2>/&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span><span class="token class-name" data-v-68cf6ec2>Messages</span></span><span class="token punctuation" data-v-68cf6ec2>/&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
  </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span><span class="token class-name" data-v-68cf6ec2>AppContext.Provider</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
</code></pre></div><p data-v-68cf6ec2>上面代码中，<code data-v-68cf6ec2>AppContext.Provider</code>提供了一个 Context 对象，这个对象可以被子组件共享。</p> <p data-v-68cf6ec2>Navbar 组件的代码如下。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token function-variable function" data-v-68cf6ec2>Navbar</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>{</span> username <span class="token punctuation" data-v-68cf6ec2>}</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useContext</span><span class="token punctuation" data-v-68cf6ec2>(</span>AppContext<span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token punctuation" data-v-68cf6ec2>(</span>
    <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span> <span class="token attr-name" data-v-68cf6ec2>className</span><span class="token attr-value" data-v-68cf6ec2><span class="token punctuation attr-equals" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>&quot;</span>navbar<span class="token punctuation" data-v-68cf6ec2>&quot;</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>AwesomeSite</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>{</span>username<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
  <span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><p data-v-68cf6ec2>上面代码中，<code data-v-68cf6ec2>useContext()</code>钩子函数用来引入 Context 对象，从中获取<code data-v-68cf6ec2>username</code>属性。</p> <p data-v-68cf6ec2>Message 组件的代码也类似。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token function-variable function" data-v-68cf6ec2>Messages</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>{</span> username <span class="token punctuation" data-v-68cf6ec2>}</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useContext</span><span class="token punctuation" data-v-68cf6ec2>(</span>AppContext<span class="token punctuation" data-v-68cf6ec2>)</span>

  <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token punctuation" data-v-68cf6ec2>(</span>
    <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span> <span class="token attr-name" data-v-68cf6ec2>className</span><span class="token attr-value" data-v-68cf6ec2><span class="token punctuation attr-equals" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>&quot;</span>messages<span class="token punctuation" data-v-68cf6ec2>&quot;</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>h1</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Messages</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>h1</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>1 message for </span><span class="token punctuation" data-v-68cf6ec2>{</span>username<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span> <span class="token attr-name" data-v-68cf6ec2>className</span><span class="token attr-value" data-v-68cf6ec2><span class="token punctuation attr-equals" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>&quot;</span>message<span class="token punctuation" data-v-68cf6ec2>&quot;</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>useContext is awesome!</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
  <span class="token punctuation" data-v-68cf6ec2>)</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><section class="re-part" data-v-68cf6ec2><div class="react-hooks-navbar" data-v-68cf6ec2><p data-v-68cf6ec2>AwesomeSite</p> <p data-v-68cf6ec2>superawesome</p></div> <div class="react-hooks-messages" data-v-68cf6ec2><h1 data-v-68cf6ec2>Messages</h1> <p data-v-68cf6ec2>1 message for </p> <p class="react-hooks-message" data-v-68cf6ec2>useContext is awesome!</p></div></section> <blockquote data-v-68cf6ec2><p data-v-68cf6ec2>点击查看<a href="https://codesandbox.io/s/react-usecontext-redux-0bj1v" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>运行结果<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="六、usereducer-action-钩子" data-v-68cf6ec2><a href="#六、usereducer-action-钩子" class="header-anchor" data-v-68cf6ec2>#</a> 六、useReducer()：action 钩子</h2> <p data-v-68cf6ec2>React 本身不提供状态管理功能，通常需要使用外部库。这方面最常用的库是 Redux。</p> <p data-v-68cf6ec2>Redux 的核心概念是，组件发出 action 与状态管理器通信。状态管理器收到 action 以后，使用 Reducer 函数算出新的状态，Reducer 函数的形式是<code data-v-68cf6ec2>(state, action) =&gt; newState</code>。</p> <p data-v-68cf6ec2><code data-v-68cf6ec2>useReducers()</code>钩子用来引入 Reducer 功能。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>state<span class="token punctuation" data-v-68cf6ec2>,</span> dispatch<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useReducer</span><span class="token punctuation" data-v-68cf6ec2>(</span>reducer<span class="token punctuation" data-v-68cf6ec2>,</span> initialState<span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
</code></pre></div><p data-v-68cf6ec2>上面是<code data-v-68cf6ec2>useReducer()</code>的基本用法，它接受 Reducer 函数和状态的初始值作为参数，返回一个数组。数组的第一个成员是状态的当前值，第二个成员是发送 action 的<code data-v-68cf6ec2>dispatch</code>函数。</p> <p data-v-68cf6ec2>下面是一个计数器的例子。用于计算状态的 Reducer 函数如下。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token function-variable function" data-v-68cf6ec2>myReducer</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>state<span class="token punctuation" data-v-68cf6ec2>,</span> action</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>switch</span><span class="token punctuation" data-v-68cf6ec2>(</span>action<span class="token punctuation" data-v-68cf6ec2>.</span>type<span class="token punctuation" data-v-68cf6ec2>)</span>  <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>case</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token string" data-v-68cf6ec2>'countUp'</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token operator" data-v-68cf6ec2>:</span>
      <span class="token keyword" data-v-68cf6ec2>return</span>  <span class="token punctuation" data-v-68cf6ec2>{</span>
        <span class="token operator" data-v-68cf6ec2>...</span>state<span class="token punctuation" data-v-68cf6ec2>,</span>
        count<span class="token operator" data-v-68cf6ec2>:</span> state<span class="token punctuation" data-v-68cf6ec2>.</span>count <span class="token operator" data-v-68cf6ec2>+</span> <span class="token number" data-v-68cf6ec2>1</span>
      <span class="token punctuation" data-v-68cf6ec2>}</span>
    <span class="token keyword" data-v-68cf6ec2>default</span><span class="token operator" data-v-68cf6ec2>:</span>
      <span class="token keyword" data-v-68cf6ec2>return</span>  state<span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><p data-v-68cf6ec2>组件代码如下。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>function</span> <span class="token function" data-v-68cf6ec2>App</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>state<span class="token punctuation" data-v-68cf6ec2>,</span> dispatch<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useReducer</span><span class="token punctuation" data-v-68cf6ec2>(</span>myReducer<span class="token punctuation" data-v-68cf6ec2>,</span> <span class="token punctuation" data-v-68cf6ec2>{</span> count<span class="token operator" data-v-68cf6ec2>:</span> <span class="token number" data-v-68cf6ec2>0</span> <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token keyword" data-v-68cf6ec2>return</span>  <span class="token punctuation" data-v-68cf6ec2>(</span>
    <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span> <span class="token attr-name" data-v-68cf6ec2>className</span><span class="token attr-value" data-v-68cf6ec2><span class="token punctuation attr-equals" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>&quot;</span>App<span class="token punctuation" data-v-68cf6ec2>&quot;</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>button</span> <span class="token attr-name" data-v-68cf6ec2>onClick</span><span class="token script language-javascript" data-v-68cf6ec2><span class="token script-punctuation punctuation" data-v-68cf6ec2>=</span><span class="token punctuation" data-v-68cf6ec2>{</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token function" data-v-68cf6ec2>dispatch</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>{</span> type<span class="token operator" data-v-68cf6ec2>:</span> <span class="token string" data-v-68cf6ec2>'countUp'</span> <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>}</span></span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
        +1
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>button</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Count: </span><span class="token punctuation" data-v-68cf6ec2>{</span>state<span class="token punctuation" data-v-68cf6ec2>.</span>count<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
  <span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><section class="re-part" data-v-68cf6ec2><button data-v-68cf6ec2>+1</button> <p data-v-68cf6ec2>Count: 0</p></section> <blockquote data-v-68cf6ec2><p data-v-68cf6ec2>点击查看<a href="https://codesandbox.io/s/react-usereducer-redux-xqlet" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>运行结果<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p data-v-68cf6ec2>由于 Hooks 可以提供共享状态和 Reducer 函数，所以它在这些方面可以取代 Redux。但是，它没法提供中间件（middleware）和时间旅行（time travel），如果你需要这两个功能，还是要用 Redux。</p> <h2 id="七、useeffect-副作用钩子" data-v-68cf6ec2><a href="#七、useeffect-副作用钩子" class="header-anchor" data-v-68cf6ec2>#</a> 七、useEffect()：副作用钩子</h2> <p data-v-68cf6ec2><code data-v-68cf6ec2>useEffect()</code>用来引入具有副作用的操作，最常见的就是向服务器请求数据。以前，放在<code data-v-68cf6ec2>componentDidMount</code>里面的代码，现在可以放在<code data-v-68cf6ec2>useEffect()</code>。</p> <p data-v-68cf6ec2><code data-v-68cf6ec2>useEffect()</code>的用法如下。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token function" data-v-68cf6ec2>useEffect</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span>  <span class="token operator" data-v-68cf6ec2>=&gt;</span>  <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token comment" data-v-68cf6ec2>// Async Action</span>
<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>,</span> <span class="token punctuation" data-v-68cf6ec2>[</span>dependencies<span class="token punctuation" data-v-68cf6ec2>]</span><span class="token punctuation" data-v-68cf6ec2>)</span>
</code></pre></div><p data-v-68cf6ec2>上面用法中，<code data-v-68cf6ec2>useEffect()</code>接受两个参数。第一个参数是一个函数，异步操作的代码放在里面。第二个参数是一个数组，用于给出 Effect 的依赖项，只要这个数组发生变化，<code data-v-68cf6ec2>useEffect()</code>就会执行。第二个参数可以省略，这时每次组件渲染时，就会执行<code data-v-68cf6ec2>useEffect()</code>。</p> <p data-v-68cf6ec2>下面看一个例子。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token function-variable function" data-v-68cf6ec2>Person</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>{</span> personId <span class="token punctuation" data-v-68cf6ec2>}</span></span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>loading<span class="token punctuation" data-v-68cf6ec2>,</span> setLoading<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useState</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token boolean" data-v-68cf6ec2>true</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>person<span class="token punctuation" data-v-68cf6ec2>,</span> setPerson<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useState</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>{</span><span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>

  <span class="token function" data-v-68cf6ec2>useEffect</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token function" data-v-68cf6ec2>setLoading</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token boolean" data-v-68cf6ec2>true</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span> 
    <span class="token function" data-v-68cf6ec2>fetch</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token template-string" data-v-68cf6ec2><span class="token template-punctuation string" data-v-68cf6ec2>`</span><span class="token string" data-v-68cf6ec2>https://swapi.co/api/people/</span><span class="token interpolation" data-v-68cf6ec2><span class="token interpolation-punctuation punctuation" data-v-68cf6ec2>${</span>personId<span class="token interpolation-punctuation punctuation" data-v-68cf6ec2>}</span></span><span class="token string" data-v-68cf6ec2>/</span><span class="token template-punctuation string" data-v-68cf6ec2>`</span></span><span class="token punctuation" data-v-68cf6ec2>)</span>
      <span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>then</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>response</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> response<span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>json</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>)</span>
      <span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>then</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>data</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
        <span class="token function" data-v-68cf6ec2>setPerson</span><span class="token punctuation" data-v-68cf6ec2>(</span>data<span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
        <span class="token function" data-v-68cf6ec2>setLoading</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token boolean" data-v-68cf6ec2>false</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
      <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>,</span> <span class="token punctuation" data-v-68cf6ec2>[</span>personId<span class="token punctuation" data-v-68cf6ec2>]</span><span class="token punctuation" data-v-68cf6ec2>)</span>

  <span class="token keyword" data-v-68cf6ec2>if</span> <span class="token punctuation" data-v-68cf6ec2>(</span>loading <span class="token operator" data-v-68cf6ec2>===</span> <span class="token boolean" data-v-68cf6ec2>true</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Loading ...</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>

  <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>You're viewing: </span><span class="token punctuation" data-v-68cf6ec2>{</span>person<span class="token punctuation" data-v-68cf6ec2>.</span>name<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Height: </span><span class="token punctuation" data-v-68cf6ec2>{</span>person<span class="token punctuation" data-v-68cf6ec2>.</span>height<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Mass: </span><span class="token punctuation" data-v-68cf6ec2>{</span>person<span class="token punctuation" data-v-68cf6ec2>.</span>mass<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
  </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
<span class="token punctuation" data-v-68cf6ec2>}</span>
</code></pre></div><p data-v-68cf6ec2>上面代码中，每当组件参数<code data-v-68cf6ec2>personId</code>发生变化，<code data-v-68cf6ec2>useEffect()</code>就会执行。组件第一次渲染时，<code data-v-68cf6ec2>useEffect()</code>也会执行。</p> <section class="re-part" data-v-68cf6ec2><div class="useEffect-height useEffect-person" data-v-68cf6ec2><p data-v-68cf6ec2>You're viewing: Jack</p> <p data-v-68cf6ec2>Height: 1.8m</p> <p data-v-68cf6ec2>Mass: 55</p></div> <div data-v-68cf6ec2>
    显示：
    <button data-v-68cf6ec2>Jack</button> <button data-v-68cf6ec2>Brave</button></div></section> <blockquote data-v-68cf6ec2><p data-v-68cf6ec2>点击查看<a href="https://codesandbox.io/s/react-useeffect-redux-9t3bg" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>运行结果<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="八、创建自己的-hooks" data-v-68cf6ec2><a href="#八、创建自己的-hooks" class="header-anchor" data-v-68cf6ec2>#</a> 八、创建自己的 Hooks</h2> <p data-v-68cf6ec2>上例的 Hooks 代码还可以封装起来，变成一个自定义的 Hook，便于共享。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token function-variable function" data-v-68cf6ec2>usePerson</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>personId</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>loading<span class="token punctuation" data-v-68cf6ec2>,</span> setLoading<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useState</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token boolean" data-v-68cf6ec2>true</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>person<span class="token punctuation" data-v-68cf6ec2>,</span> setPerson<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>useState</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>{</span><span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token function" data-v-68cf6ec2>useEffect</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token function" data-v-68cf6ec2>setLoading</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token boolean" data-v-68cf6ec2>true</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
    <span class="token function" data-v-68cf6ec2>fetch</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token template-string" data-v-68cf6ec2><span class="token template-punctuation string" data-v-68cf6ec2>`</span><span class="token string" data-v-68cf6ec2>https://swapi.co/api/people/</span><span class="token interpolation" data-v-68cf6ec2><span class="token interpolation-punctuation punctuation" data-v-68cf6ec2>${</span>personId<span class="token interpolation-punctuation punctuation" data-v-68cf6ec2>}</span></span><span class="token string" data-v-68cf6ec2>/</span><span class="token template-punctuation string" data-v-68cf6ec2>`</span></span><span class="token punctuation" data-v-68cf6ec2>)</span>
      <span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>then</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>response</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> response<span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>json</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>)</span>
      <span class="token punctuation" data-v-68cf6ec2>.</span><span class="token function" data-v-68cf6ec2>then</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2>data</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
        <span class="token function" data-v-68cf6ec2>setPerson</span><span class="token punctuation" data-v-68cf6ec2>(</span>data<span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
        <span class="token function" data-v-68cf6ec2>setLoading</span><span class="token punctuation" data-v-68cf6ec2>(</span><span class="token boolean" data-v-68cf6ec2>false</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
      <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>,</span> <span class="token punctuation" data-v-68cf6ec2>[</span>personId<span class="token punctuation" data-v-68cf6ec2>]</span><span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>  
  <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token punctuation" data-v-68cf6ec2>[</span>loading<span class="token punctuation" data-v-68cf6ec2>,</span> person<span class="token punctuation" data-v-68cf6ec2>]</span><span class="token punctuation" data-v-68cf6ec2>;</span>
<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>;</span>
</code></pre></div><p data-v-68cf6ec2>上面代码中，<code data-v-68cf6ec2>usePerson()</code>就是一个自定义的 Hook。</p> <p data-v-68cf6ec2>Person 组件就改用这个新的钩子，引入封装的逻辑。</p> <div class="language-jsx extra-class" data-v-68cf6ec2><pre class="language-jsx" data-v-68cf6ec2><code data-v-68cf6ec2><span class="token keyword" data-v-68cf6ec2>const</span> <span class="token function-variable function" data-v-68cf6ec2>Person</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token punctuation" data-v-68cf6ec2>(</span><span class="token parameter" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>{</span> personId <span class="token punctuation" data-v-68cf6ec2>}</span></span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token operator" data-v-68cf6ec2>=&gt;</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
  <span class="token keyword" data-v-68cf6ec2>const</span> <span class="token punctuation" data-v-68cf6ec2>[</span>loading<span class="token punctuation" data-v-68cf6ec2>,</span> person<span class="token punctuation" data-v-68cf6ec2>]</span> <span class="token operator" data-v-68cf6ec2>=</span> <span class="token function" data-v-68cf6ec2>usePerson</span><span class="token punctuation" data-v-68cf6ec2>(</span>personId<span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>

  <span class="token keyword" data-v-68cf6ec2>if</span> <span class="token punctuation" data-v-68cf6ec2>(</span>loading <span class="token operator" data-v-68cf6ec2>===</span> <span class="token boolean" data-v-68cf6ec2>true</span><span class="token punctuation" data-v-68cf6ec2>)</span> <span class="token punctuation" data-v-68cf6ec2>{</span>
    <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Loading ...</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token punctuation" data-v-68cf6ec2>;</span>
  <span class="token punctuation" data-v-68cf6ec2>}</span>

  <span class="token keyword" data-v-68cf6ec2>return</span> <span class="token punctuation" data-v-68cf6ec2>(</span>
    <span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>You're viewing: </span><span class="token punctuation" data-v-68cf6ec2>{</span>person<span class="token punctuation" data-v-68cf6ec2>.</span>name<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Height: </span><span class="token punctuation" data-v-68cf6ec2>{</span>person<span class="token punctuation" data-v-68cf6ec2>.</span>height<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
      </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>Mass: </span><span class="token punctuation" data-v-68cf6ec2>{</span>person<span class="token punctuation" data-v-68cf6ec2>.</span>mass<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>p</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span><span class="token plain-text" data-v-68cf6ec2>
    </span><span class="token tag" data-v-68cf6ec2><span class="token tag" data-v-68cf6ec2><span class="token punctuation" data-v-68cf6ec2>&lt;/</span>div</span><span class="token punctuation" data-v-68cf6ec2>&gt;</span></span>
  <span class="token punctuation" data-v-68cf6ec2>)</span><span class="token punctuation" data-v-68cf6ec2>;</span>
<span class="token punctuation" data-v-68cf6ec2>}</span><span class="token punctuation" data-v-68cf6ec2>;</span>
</code></pre></div><blockquote data-v-68cf6ec2><p data-v-68cf6ec2>点击查看<a href="https://codesandbox.io/s/react-useeffect-redux-ghl7c" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>运行结果<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="九、参考链接" data-v-68cf6ec2><a href="#九、参考链接" class="header-anchor" data-v-68cf6ec2>#</a> 九、参考链接</h2> <ul data-v-68cf6ec2><li data-v-68cf6ec2><a href="https://chrisachard.com/replace-redux-with-react-hooks" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>Can You Replace Redux with React Hooks?<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Chris Achard</li> <li data-v-68cf6ec2><a href="https://tylermcginnis.com/why-react-hooks/" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>Why React Hooks?<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Tyler McGinnis</li> <li data-v-68cf6ec2><a href="https://www.valentinog.com/blog/hooks/" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>React Hooks Tutorial for Beginners<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Valentino Gagliardi</li></ul> <p data-v-68cf6ec2>（完）</p> <h2 data-v-68cf6ec2>文档信息</h2> <blockquote data-v-68cf6ec2><ul data-v-68cf6ec2><li data-v-68cf6ec2>原文地址：<a href="http://www.ruanyifeng.com/blog/2019/09/react-hooks.html" target="_blank" rel="noopener noreferrer" data-v-68cf6ec2>React Hooks 入门教程<span data-v-68cf6ec2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li data-v-68cf6ec2>发表日期：2019年9月1日</li></ul></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-02-07 10:42</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><svg aria-hidden="true" class="icon inner-svg"><use xlink:href="#icon-bold-left"></use></svg> <a href="/store/react/react-started.html" class="prev">React 入门实例教程（旧）</a></span> <span class="next"><a href="/store/react/react-hooks-useeffect.html">轻松学会 React 钩子：以 useEffect() 为例</a> <svg aria-hidden="true" class="icon inner-svg"><use xlink:href="#icon-bold-right"></use></svg></span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/store/assets/js/app.394edd4d.js" defer></script><script src="/store/assets/js/2.47c138cf.js" defer></script><script src="/store/assets/js/10.5991f066.js" defer></script>
  </body>
</html>
